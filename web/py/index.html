
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="http://prg.engineer/web/py/">
      
      <link rel="icon" href="../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5">
    
    
      
        <title>py - PRG</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-BY8HY373BD"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&gtag("event","search",{search_term:this.value})}),"undefined"!=typeof location$&&location$.subscribe(function(e){gtag("config","G-BY8HY373BD",{page_path:e.pathname})})})</script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-BY8HY373BD"></script>


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#py" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="PRG" class="md-header__button md-logo" aria-label="PRG" data-md-component="logo">
      
  <img src="../../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PRG
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              py
            
          </span>
        </div>
      </div>
    </div>
    
    
      <div class="md-header__option">
        <div class="md-select">
          
          <button class="md-header__button md-icon" aria-label="Seleccionar idioma">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24z"/></svg>
          </button>
          <div class="md-select__inner">
            <ul class="md-select__list">
              
                <li class="md-select__item">
                  <a href="/" hreflang="es" class="md-select__link">
                    Español
                  </a>
                </li>
                
                <li class="md-select__item">
                  <a href="/en/" hreflang="en" class="md-select__link">
                    English
                  </a>
                </li>
                
            </ul>
          </div>
        </div>
      </div>
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Pestañas" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../js/" class="md-tabs__link md-tabs__link--active">
        Web
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PRG" class="md-nav__button md-logo" aria-label="PRG" data-md-component="logo">
      
  <img src="../../assets/logo.svg" alt="logo">

    </a>
    PRG
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Web
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Web" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Web
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../js/" class="md-nav__link">
        Js
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          py
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        py
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#links" class="md-nav__link">
    links
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#venv" class="md-nav__link">
    venv
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flask" class="md-nav__link">
    flask
  </a>
  
    <nav class="md-nav" aria-label="flask">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejemplo-basico" class="md-nav__link">
    ejemplo basico
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flask-ejem-buenisimo-api-json" class="md-nav__link">
    flask. ejem buenisimo api json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#json" class="md-nav__link">
    json
  </a>
  
    <nav class="md-nav" aria-label="json">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lectura" class="md-nav__link">
    Lectura
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#escritura" class="md-nav__link">
    Escritura
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sesiones" class="md-nav__link">
    sesiones
  </a>
  
    <nav class="md-nav" aria-label="sesiones">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objeto-flask-session" class="md-nav__link">
    Objeto Flask Session
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iterando-sobre-los-elementos-en-beautiful-soup" class="md-nav__link">
    Iterando sobre los elementos en Beautiful Soup
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plotly" class="md-nav__link">
    plotly
  </a>
  
    <nav class="md-nav" aria-label="plotly">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#proyecto" class="md-nav__link">
    Proyecto
  </a>
  
    <nav class="md-nav" aria-label="Proyecto">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objetivo" class="md-nav__link">
    Objetivo
  </a>
  
    <nav class="md-nav" aria-label="Objetivo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#instrucciones" class="md-nav__link">
    Instrucciones
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#links" class="md-nav__link">
    links
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#venv" class="md-nav__link">
    venv
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flask" class="md-nav__link">
    flask
  </a>
  
    <nav class="md-nav" aria-label="flask">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejemplo-basico" class="md-nav__link">
    ejemplo basico
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flask-ejem-buenisimo-api-json" class="md-nav__link">
    flask. ejem buenisimo api json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#json" class="md-nav__link">
    json
  </a>
  
    <nav class="md-nav" aria-label="json">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lectura" class="md-nav__link">
    Lectura
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#escritura" class="md-nav__link">
    Escritura
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sesiones" class="md-nav__link">
    sesiones
  </a>
  
    <nav class="md-nav" aria-label="sesiones">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objeto-flask-session" class="md-nav__link">
    Objeto Flask Session
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iterando-sobre-los-elementos-en-beautiful-soup" class="md-nav__link">
    Iterando sobre los elementos en Beautiful Soup
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plotly" class="md-nav__link">
    plotly
  </a>
  
    <nav class="md-nav" aria-label="plotly">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#proyecto" class="md-nav__link">
    Proyecto
  </a>
  
    <nav class="md-nav" aria-label="Proyecto">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objetivo" class="md-nav__link">
    Objetivo
  </a>
  
    <nav class="md-nav" aria-label="Objetivo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#instrucciones" class="md-nav__link">
    Instrucciones
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="py">py</h1>
<h2 id="links">links</h2>
<ul>
<li><a href="https://www.edx.org/es/course/introduction-to-python-absolute-beginner">Introduction to Python: Absolute Beginner</a> (edX).</li>
<li>
<p><a href="https://learning.edx.org/course/course-v1:UAMx+WebApp+1T2019a/">Introducción al desarrollo de aplicaciones web</a>(edx) ** de aqui es la documentacion</p>
</li>
<li>
<p><a href="https://codigofacilito.com/cursos/Python">Curso de Python Básico Gratis</a> (Web Código Facilito).</p>
</li>
</ul>
<h2 id="venv">venv</h2>
<p>requirements.txt</p>
<div class="highlight"><pre><span></span><code>flask
</code></pre></div>
<div class="highlight"><pre><span></span><code>pk@pk:~$ <span class="nb">type</span> vvvv
vvvv <span class="o">()</span> 
<span class="o">{</span> 
    deactivate<span class="p">;</span>
    python3.8 -m venv ./.venv<span class="p">;</span>
    <span class="nb">source</span> ./.venv/bin/activate<span class="p">;</span>
    pip install -r requirements.txt<span class="p">;</span>
    python app.py
<span class="o">}</span>
pk@pk:~$ 
pk@pk:~$ 
</code></pre></div>
<h2 id="flask">flask</h2>
<h3 id="ejemplo-basico">ejemplo basico</h3>
<p>app.py</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span><span class="n">request</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="n">user_agent</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;User-Agent&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;&lt;p&gt;Your browser is </span><span class="si">%s</span><span class="s1">&lt;/p&gt;&#39;</span> <span class="o">%</span> <span class="n">user_agent</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/processLogin&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">process_login</span><span class="p">():</span>
       <span class="n">missing</span> <span class="o">=</span> <span class="p">[]</span>
       <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;passwd&#39;</span><span class="p">,</span> <span class="s1">&#39;login_submit&#39;</span><span class="p">]</span>
       <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
              <span class="n">value</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
              <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                  <span class="n">missing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
       <span class="k">if</span> <span class="n">missing</span><span class="p">:</span>
              <span class="k">return</span> <span class="s2">&quot;Warning: Some fields are missing&quot;</span>

       <span class="k">return</span> <span class="s1">&#39;&lt;!DOCTYPE html&gt; &#39;</span> \
           <span class="s1">&#39;&lt;html lang=&quot;es&quot;&gt;&#39;</span> \
           <span class="s1">&#39;&lt;head&gt;&#39;</span> \
           <span class="s1">&#39;&lt;link href=&quot;static/css/my-socnet-style.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;/&gt;&#39;</span> \
           <span class="s1">&#39;&lt;title&gt; Home - SocNet &lt;/title&gt;&#39;</span> \
           <span class="s1">&#39;&lt;/head&gt;&#39;</span> \
           <span class="s1">&#39;&lt;body&gt; &lt;div id =&quot;container&quot;&gt;&#39;</span> \
           <span class="s1">&#39;&lt;a href=&quot;/&quot;&gt; SocNet &lt;/a&gt; | &lt;a href=&quot;home&quot;&gt; Home &lt;/a&gt; | &lt;a href=&quot;login&quot;&gt; Log In &lt;/a&gt; | &lt;a href=&quot;signup&quot;&gt; Sign Up &lt;/a&gt;&#39;</span> \
           <span class="s1">&#39;&lt;h1&gt;Data from Form: Login&lt;/h1&gt;&#39;</span> \
           <span class="s1">&#39;&lt;form&gt;&lt;label&gt;email: &#39;</span> <span class="o">+</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span> <span class="o">+</span> \
           <span class="s1">&#39;&lt;/label&gt;&lt;br&gt;&lt;label&gt;passwd: &#39;</span> <span class="o">+</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;passwd&#39;</span><span class="p">]</span> <span class="o">+</span> \
           <span class="s1">&#39;&lt;/label&gt;&lt;/form&gt;&lt;/div&gt;&lt;/body&gt;&#39;</span> \
           <span class="s1">&#39;&lt;/html&gt;&#39;</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;ubuntu&#39;</span><span class="p">:</span>  
        <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8080</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
</code></pre></div>
<p>index.html</p>
<div class="highlight"><pre><span></span><code>
</code></pre></div>
<h3 id="flask-ejem-buenisimo-api-json">flask. ejem buenisimo api json</h3>
<div class="highlight"><pre><span></span><code><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">http://127.0.0.1:8080/songs/all</span>


<span class="sd">import requests</span>
<span class="sd">cancion={</span>
<span class="sd">    &#39;Artista&#39;:&#39;dfasfd&#39;,</span>
<span class="sd">    &#39;Nombre&#39;:&#39;jojo&#39;</span>
<span class="sd">}</span>

<span class="sd">respuesta=requests.get(&#39;http://127.0.0.1:8080/songs/all&#39;)</span>
<span class="sd">print(&#39;\n&#39;,respuesta.content.decode())</span>

<span class="sd">respuesta=requests.post(&#39;http://127.0.0.1:8080/songs/new&#39;,json=cancion)</span>
<span class="sd">print(&#39;\n&#39;,respuesta.content.decode())</span>

<span class="sd">respuesta=requests.get(&#39;http://127.0.0.1:8080/songs/all&#39;)</span>
<span class="sd">print(&#39;\n&#39;,respuesta.content.decode())</span>

<span class="sd">respuesta=requests.patch(&#39;http://127.0.0.1:8080/songs/2&#39;, json={&#39;Artista&#39;:&#39;jijiji&#39;})</span>
<span class="sd">print(&#39;\n&#39;,respuesta.content.decode())</span>

<span class="sd">respuesta=requests.get(&#39;http://127.0.0.1:8080/songs/all&#39;)</span>
<span class="sd">print(&#39;\n&#39;,respuesta.content.decode())</span>


<span class="sd">&#39;&#39;&#39;</span>


<span class="c1"># Ejemplo API</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">jsonify</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">song_db</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
     <span class="s2">&quot;Artista&quot;</span><span class="p">:</span> <span class="s2">&quot;Air Supply&quot;</span><span class="p">,</span>
     <span class="s2">&quot;Nombre&quot;</span><span class="p">:</span> <span class="s2">&quot;Making Love Out of Nothing at All&quot;</span>
     <span class="p">},</span>
     <span class="p">{</span>
     <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
     <span class="s2">&quot;Artista&quot;</span><span class="p">:</span> <span class="s2">&quot;Bonnie Tyle&quot;</span><span class="p">,</span>
     <span class="s2">&quot;Nombre&quot;</span><span class="p">:</span> <span class="s2">&quot;Total Eclipse Of The Heart&quot;</span>
     <span class="p">},</span>
     <span class="p">{</span>
     <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
     <span class="s2">&quot;Artista&quot;</span><span class="p">:</span> <span class="s2">&quot;George Michael&quot;</span><span class="p">,</span>
     <span class="s2">&quot;Nombre&quot;</span><span class="p">:</span> <span class="s2">&quot;Careless Whisper&quot;</span>
     <span class="p">},</span>
     <span class="p">{</span>
     <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
     <span class="s2">&quot;Artista&quot;</span><span class="p">:</span> <span class="s2">&quot;Berlin&quot;</span><span class="p">,</span>
     <span class="s2">&quot;Nombre&quot;</span><span class="p">:</span> <span class="s2">&quot;Take My Breath Away&quot;</span>
     <span class="p">},</span>
     <span class="p">{</span>
     <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
     <span class="s2">&quot;Artista&quot;</span><span class="p">:</span> <span class="s2">&quot;Queen&quot;</span><span class="p">,</span>
     <span class="s2">&quot;Nombre&quot;</span><span class="p">:</span> <span class="s2">&quot;Bohemian Rhapsody&quot;</span>
     <span class="p">}</span>
 <span class="p">]</span>


<span class="c1"># GET | returns the whole catalog</span>
<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/songs/all&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_all</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">song_db</span><span class="p">),</span> <span class="mi">200</span>

<span class="c1"># GET | returns an entry by an id</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/songs/&lt;int:song_id&gt;&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_song</span><span class="p">(</span><span class="n">song_id</span><span class="p">):</span>
    <span class="n">song_result</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
        <span class="p">(</span><span class="n">song</span> <span class="k">for</span> <span class="n">song</span> <span class="ow">in</span> <span class="n">song_db</span> <span class="k">if</span> <span class="n">song</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">song_id</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">song_result</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">jsonify</span><span class="p">(</span><span class="n">song_result</span><span class="p">),</span> <span class="mi">200</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;404 Not Found&quot;</span><span class="p">,</span> <span class="mi">404</span>
<span class="c1"># GET | returns all songs with the same name</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/songs/search/&lt;string:song_name&gt;&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">search_song</span><span class="p">(</span><span class="n">song_name</span><span class="p">):</span>
    <span class="n">songs</span> <span class="o">=</span> <span class="p">[</span><span class="n">song</span> <span class="k">for</span> <span class="n">song</span> <span class="ow">in</span> <span class="n">song_db</span> <span class="k">if</span> <span class="n">song_name</span> <span class="ow">in</span> <span class="n">song</span><span class="p">[</span><span class="s2">&quot;Nombre&quot;</span><span class="p">]]</span>

    <span class="k">if</span> <span class="n">songs</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">jsonify</span><span class="p">(</span><span class="n">songs</span><span class="p">),</span> <span class="mi">200</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;404 Not Found&quot;</span><span class="p">,</span> <span class="mi">404</span>

<span class="c1"># POST | creates a new entry in the catalog</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/songs/new&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;POST&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">post_song</span><span class="p">():</span>

    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
        <span class="n">song_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="n">song_id</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">song</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">song</span> <span class="ow">in</span> <span class="n">song_db</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">song_artist</span> <span class="o">=</span> <span class="n">song_data</span><span class="p">[</span><span class="s2">&quot;Artista&quot;</span><span class="p">]</span>
        <span class="n">song_name</span> <span class="o">=</span> <span class="n">song_data</span><span class="p">[</span><span class="s2">&quot;Nombre&quot;</span><span class="p">]</span>

        <span class="n">new_song</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">song_id</span><span class="p">,</span>
            <span class="s2">&quot;Artista&quot;</span><span class="p">:</span> <span class="n">song_artist</span><span class="p">,</span>
            <span class="s2">&quot;Nombre&quot;</span><span class="p">:</span> <span class="n">song_name</span>
      <span class="p">}</span>

        <span class="n">song_db</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_song</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">new_song</span><span class="p">),</span> <span class="mi">200</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;400 Bad Request&quot;</span><span class="p">,</span> <span class="mi">400</span>

<span class="c1"># DELETE | deletes an entry in the catalog by an id</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/songs/&lt;int:song_id&gt;&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DELETE&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">delete_song</span><span class="p">(</span><span class="n">song_id</span><span class="p">):</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">song</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">song_db</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">song</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">song_id</span><span class="p">:</span>
            <span class="n">song_db</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

            <span class="k">return</span> <span class="s2">&quot;Register Deleted&quot;</span><span class="p">,</span> <span class="mi">200</span>

    <span class="k">return</span> <span class="s2">&quot;Not Found&quot;</span><span class="p">,</span> <span class="mi">404</span>

<span class="c1"># PUT | replaces an entry in the catalog, creates a new entry if it doesn&#39;t exist</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/songs/&lt;int:song_id&gt;&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PUT&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">put_song</span><span class="p">(</span><span class="n">song_id</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
         <span class="n">song_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

         <span class="n">song_artist</span> <span class="o">=</span> <span class="n">song_data</span><span class="p">[</span><span class="s2">&quot;Artista&quot;</span><span class="p">]</span>
         <span class="n">song_name</span> <span class="o">=</span> <span class="n">song_data</span><span class="p">[</span><span class="s2">&quot;Nombre&quot;</span><span class="p">]</span>

         <span class="n">edit_song</span> <span class="o">=</span> <span class="p">{</span>
             <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">song_id</span><span class="p">,</span>
             <span class="s2">&quot;Artista&quot;</span><span class="p">:</span> <span class="n">song_artist</span><span class="p">,</span>
             <span class="s2">&quot;Nombre&quot;</span><span class="p">:</span> <span class="n">song_name</span>
        <span class="p">}</span>

         <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">song</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">song_db</span><span class="p">):</span>
             <span class="k">if</span> <span class="n">song</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">song_id</span><span class="p">:</span>
                 <span class="n">song_db</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">edit_song</span>

                 <span class="k">return</span> <span class="p">(</span><span class="n">jsonify</span><span class="p">(</span><span class="n">edit_song</span><span class="p">),</span> <span class="mi">200</span><span class="p">)</span>

         <span class="n">edit_song</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">song</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">song</span> <span class="ow">in</span> <span class="n">song_db</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span>
         <span class="n">song_db</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">edit_song</span><span class="p">)</span>

         <span class="k">return</span> <span class="p">(</span><span class="n">jsonify</span><span class="p">(</span><span class="n">edit_song</span><span class="p">),</span> <span class="mi">200</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
         <span class="k">return</span> <span class="s2">&quot;Bad Request&quot;</span><span class="p">,</span> <span class="mi">400</span>


<span class="c1"># PATCH | edits an entry in the catalog, fails if it doesn&#39;t exist</span>
<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/songs/&lt;int:song_id&gt;&quot;</span><span class="p">,</span> <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;PATCH&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">patch_song</span><span class="p">(</span><span class="n">song_id</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">song</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">song_db</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">song</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">song_id</span><span class="p">:</span>
                <span class="n">song_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">edit_key</span> <span class="ow">in</span> <span class="n">song_data</span><span class="p">:</span>
                    <span class="n">song</span><span class="p">[</span><span class="n">edit_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">song_data</span><span class="p">[</span><span class="n">edit_key</span><span class="p">]</span>

                <span class="k">return</span> <span class="p">(</span><span class="n">jsonify</span><span class="p">(</span><span class="n">song</span><span class="p">),</span> <span class="mi">200</span><span class="p">)</span>

        <span class="k">return</span> <span class="s2">&quot;Not Found&quot;</span><span class="p">,</span> <span class="mi">404</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Bad Request&quot;</span><span class="p">,</span> <span class="mi">400</span>

<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8080</span><span class="p">)</span>
</code></pre></div>
<h2 id="json">json</h2>
<p>Las estructuras de JSON tienen una traducción directa a estructuras Python:</p>
<ul>
<li>Los objetos JSON son representados como diccionarios en Python</li>
<li>Los arrays JSON son representados como listas en Python</li>
<li>true y false en JSON son valores del tipo <em>boolean</em> en Python</li>
<li>Las cadenas en JSON son cadenas en Python</li>
<li>Los números en JSON son <em>float</em> o <em>integer</em>, según corresponda, en Python</li>
</ul>
<p>Por este motivo, las funciones para leer y escribir ficheros JSON son muy sencillas de utilizar. En ambos casos recurrimos a la biblioteca  JSON, así que lo primero que debemos hacer es:</p>
<div class="highlight"><pre><span></span><code>import json
</code></pre></div>
<h3 id="lectura">Lectura</h3>
<p>La función para leer un fichero JSON es json.load. Como parámetro un fichero, así que una forma normal de usarla es:</p>
<div class="highlight"><pre><span></span><code>with open(“nombre_fichero.json”, &#39;r&#39;) as f:
   data = json.load(f)
</code></pre></div>
<p>Después de ejecutar esto, la variable <em>data</em> contendrá un  diccionario con los datos cargados del fichero. Si por ejemplo  hubiéramos cargado el fichero con los datos del usuario <em>James</em>  visto en la sección anterior, ahora data[‘user_name’] sería “James” y  data[‘messages’] sería una lista Python con los mensajes publicados por  James.</p>
<h3 id="escritura">Escritura</h3>
<p>Volcar una estructura Python a un fichero JSON es igual de sencillo.  Supongamos que tenemos la siguiente inicialización de la variable datos:</p>
<div class="highlight"><pre><span></span><code><span class="err">da</span><span class="kc">t</span><span class="err">os</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;user_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;James&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;password&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">“</span><span class="mi">007</span><span class="err">”</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;messages&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">(</span><span class="mf">1532648502.113984</span><span class="p">,</span><span class="w"> </span><span class="err">“me</span><span class="kc">nsa</span><span class="err">je</span><span class="w"> </span><span class="mi">1</span><span class="err">”)</span><span class="p">,</span><span class="w"> </span><span class="err">(</span><span class="mf">1532648642.729385</span><span class="p">,</span><span class="w">     </span><span class="err">“me</span><span class="kc">nsa</span><span class="err">je</span><span class="w"> </span><span class="mi">1</span><span class="err">”)</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">sessio</span><span class="kc">n</span><span class="p">[</span><span class="err">&#39;email&#39;</span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;friends&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">sessio</span><span class="kc">n</span><span class="p">[</span><span class="err">&#39;</span><span class="kc">fr</span><span class="err">ie</span><span class="kc">n</span><span class="err">ds&#39;</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Entonces guardar los datos en el fichero correspondiente sería:</p>
<div class="highlight"><pre><span></span><code><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="err">“</span><span class="n">james</span><span class="o">.</span><span class="n">bond</span><span class="nd">@mi6</span><span class="o">.</span><span class="n">uk</span><span class="err">”</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">datos</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div>
<h2 id="sesiones">sesiones</h2>
<p>Ya hemos dicho en varias  oportunidades que el protocolo HTTP no tiene estado, que no recuerda.  ¿Qué significa eso en la práctica? Que necesitamos información adicional para implementar una “conversación” entre cliente y servidor. Esta idea de conversación, donde ambas partes recuerdan lo que han hablado hasta  el momento, se llama <strong>sesión</strong>.</p>
<p>Aunque el concepto o la duración de una sesión puede variar en distintos entornos, básicamente es el conjunto de interacciones entre cliente y servidor en un lapso de tiempo razonable.</p>
<p>La primera vez que un cliente realiza una petición, después de un tiempo sin interactuar, el servidor <strong>abre una sesión</strong>. Las subsecuentes peticiones desde ese cliente se consideran dentro de  la misma sesión. Si pasa mucho tiempo sin que el cliente realice una  petición, el servidor asume que ya no está conectado y termina la  sesión.</p>
<p>La biblioteca Flask nos ofrece este concepto de sesión. Pero si HTTP  no tiene información específica que permita identificar al usuario o la  sesión, ¿cómo sabe Flask a qué usuario corresponde una determinada  petición?</p>
<p>Existen al menos 3 formas de que una petición HTTP transporte información que permita identificar al usuario o la sesión:</p>
<ul>
<li><strong>Cookies</strong>: las <em>cookies</em> son pequeños ficheros que se adjuntan a una respuesta HTTP, con información de identificación de usuario. En sucesivas peticiones HTTP, el navegador incluye ese  fichero automáticamente, por lo que el servidor podrá tener la  identificación de ese usuario.</li>
<li><strong>Campos ocultos</strong>: en los formularios que el servidor envía a cliente para que sean completados, incluyo un campo del tipo <em>input</em> que no se muestra al usuario; ese campo lleva información que cuando  los datos del formulario se envíen de vuelta al servidor le servirá para identificar al cliente.</li>
<li><strong>Reescritura de URLs</strong>: aunque nos parezcan iguales,  el servidor introduce automáticamente pequeñas modificaciones a las  URLs; de esta forma, la URL específica que solicite permitirá al  servidor identificar al cliente.</li>
</ul>
<p>La buena noticia es que, generalmente, el mecanismo que se use para  transportar la información de sesión no es visible al desarrollador de  la aplicación web. Esto es exactamente lo que ocurre con el soporte de  sesiones que nos ofrece Flask, y que veremos a continuación.</p>
<p>Vamos a ver cómo podemos  manejar una sesión en Python y Flask para poder almacenar información  entre cada una de las peticiones que el cliente haga al servidor.</p>
<h3 id="objeto-flask-session">Objeto Flask Session</h3>
<p>El objeto que nos guarda la información entre sesiones se llama  session. Lo primero será importarlo dentro de nuestro código Python para luego poder usarlo:</p>
<div class="highlight"><pre><span></span><code>from flask import Flask, session
</code></pre></div>
<p>Como la información de la sesión viaja del servidor al cliente ida y  vuelta, es importante que nadie en el camino, ni siquiera el propio  cliente, puedan alterar esa información. En particular, se debe evitar  que alguien de fuera “tome control” de la sesión. En seguridad  informática, este tipo de ataque se conoce como CSRF (Cross-site request forgery) o robo de sesión.</p>
<p>Para asegurarse que eso no ocurre, Flask utiliza técnicas de  encriptación para proteger la información. Para eso, necesita una clav  de encriptación/desencriptación. Esta clave, que sólo debe conocer el  servidor y que debe ser distinta para todos los programas servidor, se  crea en el propio código del servidor. Por ejemplo:</p>
<div class="highlight"><pre><span></span><code>app.secret_key = &#39;esto-es-una-clave-muy-secreta&#39;
</code></pre></div>
<p>De hecho, en el código de nuestra aplicación SocNet habrás visto una línea similar a esta:</p>
<div class="highlight"><pre><span></span><code>app.secret_key = &#39;A0Zr98j/3yX R~XHH!jmN]LWX/,?RT&#39;
</code></pre></div>
<p>Ahora ya sabes para qué sirve. Si quieres tener más información de  este problema de seguridad informática y su solución, puedes leer <a href="http://flask.pocoo.org/snippets/3/">aquí</a>.</p>
<p>Ahora vamos a ver ejemplo de cómo utilizamos las sesiones en nuestra aplicación favorita.</p>
<p>La primera función, <strong>*load_user(email, passwd)*</strong>, intenta cargar los datos desde un fichero.</p>
<p><strong>Importante</strong>: aquí almacenamos los datos en un fichero por una cuestión de  simplicidad. En aplicaciones con cientos o miles de usuarios lo normal  es almacenar los datos en una base de datos propiamente dicha.</p>
<p>Si el fichero existe, carga los datos y a continuación comprueba que la clave suministrada coincida con la que está almacenada.</p>
<p><strong>Nota de seguridad</strong>: otra vez, para facilitar las explicaciones y la comprensión de los  conceptos básicos, realizamos algunas simplificaciones que antes de  hacer público un sistema deben ser corregidas. Por ejemplo, nunca se  debe guardar una clave de usuario “en claro”, siempre se debe hacer  codificada con algún algoritmo como por ejemplo SHA-256. Lamentable  estas cuestiones quedan fuera del ámbito de este curso.</p>
<p>Si todas las condiciones son correctas, la función <strong>guarda</strong> los datos relevantes del usuario (nombre, mensajes que ha escrito hasta el momento, la clave, su correo electrónico y la lista de amigos) en la <strong>sesión</strong>, para que estén disponibles para las próxima llamadas desde el cliente.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">load_user</span><span class="p">(</span><span class="n">email</span><span class="p">,</span> <span class="n">passwd</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    It loads data for the given user (identified by email) from the data directory.</span>
<span class="sd">    It looks for a file whose name matches the user email</span>
<span class="sd">    :param email: user id</span>
<span class="sd">    :param passwd: password to check in order to validate the user</span>
<span class="sd">    :return: content of the home page (app basic page) if user exists and password is correct</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SITE_ROOT</span><span class="p">,</span> <span class="s2">&quot;data/&quot;</span><span class="p">,</span> <span class="n">email</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">process_error</span><span class="p">(</span><span class="s2">&quot;User not found / No existe un usuario con ese nombre&quot;</span><span class="p">,</span> <span class="n">url_for</span><span class="p">(</span><span class="s2">&quot;login&quot;</span><span class="p">))</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">passwd</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">process_error</span><span class="p">(</span><span class="s2">&quot;Incorrect password / la clave no es correcta&quot;</span><span class="p">,</span> <span class="n">url_for</span><span class="p">(</span><span class="s2">&quot;login&quot;</span><span class="p">))</span>
    <span class="n">session</span><span class="p">[</span><span class="s1">&#39;user_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;user_name&#39;</span><span class="p">]</span>
    <span class="n">session</span><span class="p">[</span><span class="s1">&#39;messages&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;messages&#39;</span><span class="p">]</span>
    <span class="n">session</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">passwd</span>
    <span class="n">session</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">email</span>
    <span class="n">session</span><span class="p">[</span><span class="s1">&#39;friends&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;friends&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s2">&quot;home&quot;</span><span class="p">))</span>
</code></pre></div>
<p>De la misma forma, cuando un usuario quiere salir del sistema, debemos guardar los datos en el fichero (base de datos) para que estén disponibles la próxima vez que el  usuario vuelva a nuestra aplicación. Este es el objetivo de la función <em>save_current_user()</em>, que vuelca los datos de session en el fichero correspondiente.</p>
<p>Por otra parte, cuando un usuario se da de alta, se debe crear el fichero, previa comprobación que no exista un usuario con el mismo identificador (correo electrónico). Esto es lo que hace la función <em>create_user_file(name, email, passwd, passwd_confirmation)</em>.</p>
<div class="highlight"><pre><span></span><code>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">save_current_user</span><span class="p">():</span>
    <span class="n">datos</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;user_name&quot;</span><span class="p">:</span> <span class="n">session</span><span class="p">[</span><span class="s2">&quot;user_name&quot;</span><span class="p">],</span>
        <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="n">session</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">],</span>
        <span class="s2">&quot;messages&quot;</span><span class="p">:</span> <span class="n">session</span><span class="p">[</span><span class="s1">&#39;messages&#39;</span><span class="p">],</span> <span class="c1"># lista de tuplas (time_stamp, mensaje)</span>
        <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="n">session</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">],</span>
        <span class="s2">&quot;friends&quot;</span><span class="p">:</span> <span class="n">session</span><span class="p">[</span><span class="s1">&#39;friends&#39;</span><span class="p">]</span>
    <span class="p">}</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SITE_ROOT</span><span class="p">,</span> <span class="s2">&quot;data/&quot;</span><span class="p">,</span> <span class="n">session</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">])</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">datos</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_user_file</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">email</span><span class="p">,</span> <span class="n">passwd</span><span class="p">,</span> <span class="n">passwd_confirmation</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    It creates the file (in the /data directory) for storing user data. The file name will match the user email.</span>
<span class="sd">    If the file already exists, it returns an error.</span>
<span class="sd">    If the password does not match the confirmation, it returns an error.</span>
<span class="sd">    :param name: Name or nickname of the user</span>
<span class="sd">    :param email: user email, which will be later used for retrieving data</span>
<span class="sd">    :param passwd: password for future logins</span>
<span class="sd">    :param passwd_confirmation: confirmation, must match the password</span>
<span class="sd">    :return: if no error is found, it sends the user to the home page</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SITE_ROOT</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SITE_ROOT</span><span class="p">,</span> <span class="s2">&quot;data/&quot;</span><span class="p">,</span> <span class="n">email</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">process_error</span><span class="p">(</span><span class="s2">&quot;The email is already used, you must select a different email / Ya existe un usuario con ese nombre&quot;</span><span class="p">,</span> <span class="n">url_for</span><span class="p">(</span><span class="s2">&quot;signup&quot;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">passwd</span> <span class="o">!=</span> <span class="n">passwd_confirmation</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">process_error</span><span class="p">(</span><span class="s2">&quot;Your password and confirmation password do not match / Las claves no coinciden&quot;</span><span class="p">,</span> <span class="n">url_for</span><span class="p">(</span><span class="s2">&quot;signup&quot;</span><span class="p">))</span>
    <span class="n">datos</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;user_name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
        <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="n">passwd</span><span class="p">,</span>
        <span class="s2">&quot;messages&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;friends&quot;</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">}</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">datos</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    <span class="n">session</span><span class="p">[</span><span class="s1">&#39;user_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>
    <span class="n">session</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">passwd</span>
    <span class="n">session</span><span class="p">[</span><span class="s1">&#39;messages&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">session</span><span class="p">[</span><span class="s1">&#39;friends&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">session</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">email</span>
    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s2">&quot;home&quot;</span><span class="p">))</span>
</code></pre></div>
<h3 id="iterando-sobre-los-elementos-en-beautiful-soup">Iterando sobre los elementos en <strong>Beautiful Soup</strong></h3>
<p>Hasta el momento se han visto dos principales maneras de cómo se  puede utilizar el árbol jerárquico producido por BeautifulSoup con base a una página web: utilizando métodos de búsqueda, y navegando manualmente por los elementos, cada uno con sus ventajas y desventajas. Sin  embargo, podemos utilizar un enfoque intermedio entre estos dos extremos y es el de utilizar métodos de iteración sobre los elementos. De esta  forma podemos tener la ventaja de la flexibilidad de la búsqueda, pero  con el poder de ajustar la selección de los elementos de forma manual.</p>
<p>Para lograr este objetivo, BeautifulSoup cuenta con diferentes herramientas y métodos,siendo uno de ellos el atributo “<strong>descendants</strong>”. Su comportamiento es similar al de “<strong>children</strong>” pero no solo se limita a los elementos inmediatos, si no que enlista  todos los elementos, es decir, los hijos, los hijos de los hijos, etc.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Ejemplo 1</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>


<span class="n">page</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="err">“</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">datolok</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">python</span><span class="o">-</span><span class="n">edx</span><span class="o">/</span>
<span class="n">webscrapping</span><span class="o">/</span><span class="n">simple</span><span class="o">.</span><span class="n">html</span><span class="err">”</span><span class="p">)</span>
<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="err">‘</span><span class="n">html</span><span class="o">.</span><span class="n">parser</span><span class="err">’</span><span class="p">)</span>


<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">descendants</span><span class="p">:</span>
     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Element </span><span class="si">{}</span><span class="s2">: </span><span class="se">\n</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">element</span><span class="p">))</span>
</code></pre></div>
<p>En este código se carga la página que se ha utilizado de ejemplo y se imprimen todos los elementos contenidos por medio de un ciclo for. Esto se puede combinar con otros conceptos, como la de expresiones  regulares, para identificar palabras claves o patrones de información.</p>
<p>Este proceso de búsqueda dentro de un elemento en particular puede  aplicarse al resultado de otros procesos como el de búsqueda o  navegación.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Ejemplo 2</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>


<span class="n">page</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="err">“</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">datolok</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">python</span><span class="o">-</span><span class="n">edx</span><span class="o">/</span>
<span class="n">webscrapping</span><span class="o">/</span><span class="n">simple</span><span class="o">.</span><span class="n">html</span><span class="err">”</span><span class="p">)</span>
<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="err">‘</span><span class="n">html</span><span class="o">.</span><span class="n">parser</span><span class="err">’</span><span class="p">)</span>


<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="err">“</span><span class="n">p</span><span class="err">”</span><span class="p">):</span>
    <span class="k">if</span> <span class="err">“</span><span class="n">contenido</span><span class="err">”</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">get_text</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_text</span><span class="p">())</span>
</code></pre></div>
<p>En este código se encuentran todos los elementos de tipo párrafo  <p> en el documento, se iteran sobre todos los resultados y se  imprimen aquellos que contengan la palabra “contenido”. Como se puede  observar esto abre un abanico de nuevas posibilidades para automatizar  nuestro proceso de búsqueda y no depender demasiado en que la estructura de la página web no varíe.</p>
<p>Igualmente, no estamos limitados a solamente definir nuestro criterio de selección en la iteración con el contenido del texto, también  podemos acceder a los atributos de los elementos utilizando el método  “get()”.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Ejemplo 3</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>


<span class="n">page</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="err">“</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">datolok</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">python</span><span class="o">-</span><span class="n">edx</span><span class="o">/</span>
<span class="n">webscrapping</span><span class="o">/</span><span class="n">simple</span><span class="o">.</span><span class="n">html</span><span class="err">”</span><span class="p">)</span>
<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="err">‘</span><span class="n">html</span><span class="o">.</span><span class="n">parser</span><span class="err">’</span><span class="p">)</span>


<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="err">“</span><span class="n">p</span><span class="err">”</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;outer-text&quot;</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="err">“</span><span class="n">class</span><span class="err">”</span><span class="p">),</span><span class="n">p</span><span class="o">.</span><span class="n">get_text</span><span class="p">())</span>
</code></pre></div>
<h2 id="plotly">plotly</h2>
<h3 id="proyecto">Proyecto</h3>
<h4 id="objetivo">Objetivo</h4>
<p>El objetivo del proyecto será explorar, de manera básica, cómo agregar anotaciones en nuestras gráficas generadas con plotly.</p>
<p>En particular, aprenderás cómo agregar anotaciones para señalar puntos específicos de la gráfica de línea que revisamos en el primer  ejemplo de la unidad 5.</p>
<h5 id="instrucciones">Instrucciones</h5>
<p>Completa las partes faltantes del código para obtener el siguiente resultado:</p>
<p>​       <img alt="Gráfica en línea" src="../py.assets/Proyecto_Mo_dulo3.png" /> </p>
<p>La primera parte del código, donde definimos los datos para graficar, es esta:</p>
<div class="highlight"><pre><span></span><code><span class="mi">1</span>   <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="mi">2</span>   <span class="kn">import</span> <span class="nn">plotly.offline</span> <span class="k">as</span> <span class="nn">pyo</span>
<span class="mi">3</span>   <span class="kn">import</span> <span class="nn">plotly.graph_objs</span> <span class="k">as</span> <span class="nn">go</span>
<span class="mi">4</span>
<span class="mi">5</span>   <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="mi">6</span>   <span class="n">x_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="mi">7</span>   <span class="n">y_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="mi">8</span>
<span class="mi">9</span>   <span class="c1">#Calcular el promedio de los valores de y_values</span>
<span class="mi">10</span>  <span class="n">y_avg</span> <span class="o">=</span> <span class="c1">#Completar1</span>
<span class="mi">11</span>
<span class="mi">12</span>  <span class="c1">#Calcular el valor máximo de y_values</span>
<span class="mi">13</span>  <span class="n">y_max</span> <span class="o">=</span> <span class="c1">#Completar2</span>
<span class="mi">14</span>
<span class="mi">15</span>  <span class="c1">#Calcular el valor x_y_max tal que (x_y_max, y_max) sea el punto máximo de la gráfica de línea</span>
<span class="mi">16</span>  <span class="n">x_y_max</span> <span class="o">=</span> <span class="c1">#Completar3</span>
</code></pre></div>
<p>Como mencionamos antes, este proyecto inicia igual que el  ejemplo que revisamos en la unidad 5. Las primeras 7 líneas del código  son igual que en dicho ejemplo.</p>
<p>En la línea 10 deberás completar el código para que en la variable <code>y_avg</code> sea igual al promedio de los valores del <code>array y_values</code>.</p>
<p>En la línea 13 deberás completar el código para que en la variable <code>y_max</code> sea igual al valor máximo del <code>array y_values</code>.</p>
<p>En la línea 16 deberás completar el código para que la variable <code>x_y_max</code> tenga el valor tal que el punto <code>(x_y_max, y_max)</code> sea el punto máximo de la gráfica de línea.</p>
<p>Observa que a estas partes faltantes las hemos etiquetado como <strong>#Completar1</strong>, <strong>#Completar2</strong> y <strong>#Completar3</strong>, para poder hacer referencia a ellas después.</p>
<p>La segunda parte del código, donde definimos las gráficas que visualizaremos, es esta:</p>
<div class="highlight"><pre><span></span><code><span class="mi">17</span>
<span class="mi">18</span>  <span class="n">trace1</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_values</span><span class="p">,</span>
<span class="mi">19</span>                     <span class="n">y</span><span class="o">=</span><span class="n">y_values</span><span class="p">,</span>
<span class="mi">20</span>                     <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Datos&#39;</span><span class="p">,</span>
<span class="mi">21</span>                     <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">)</span>
<span class="mi">22</span>  
<span class="mi">23</span>  <span class="c1">#Definir los parámetros x e y de modo que:</span>
<span class="mi">24</span>  <span class="c1">#Se genere una línea punteada horizontal a la altura del promedio de y_values</span>
<span class="mi">25</span>  <span class="n">trace2</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="c1">#Completar4,</span>
<span class="mi">26</span>                     <span class="n">y</span><span class="o">=</span><span class="c1">#Completar5,</span>
<span class="mi">27</span>                     <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Promedio&#39;</span><span class="p">,</span>
<span class="mi">28</span>                     <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
<span class="mi">29</span>                     <span class="n">line</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dash&#39;</span><span class="p">:</span><span class="s1">&#39;dash&#39;</span><span class="p">})</span>
<span class="mi">30</span>  
<span class="mi">31</span>  <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">trace1</span><span class="p">,</span> <span class="n">trace2</span><span class="p">]</span>
<span class="mi">32</span>  <span class="n">layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Gráfica de línea&#39;</span><span class="p">)</span>
<span class="mi">33</span>  <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
</code></pre></div>
<p>En la línea 18 creamos el <code>trace1</code> con un <code>go.Scatter()</code>, como vimos en el ejemplo de la unidad 5.</p>
<p>En la línea 25 creamos el <code>trace2</code> también con <code>go.Scatter()</code>.</p>
<p>Aquí deberás definir de manera apropiada los parámetros x e y (elementos <strong>#Completar4</strong> y <strong>#Completar5</strong>), de modo que el resultado sea una línea punteada horizontal que esté a la altura del promedio de los valores del <code>array y_values</code>.</p>
<p>Las líneas 31, 32 y 33 ya las hemos discutido en la unidad 5.</p>
<p>La tercera y última parte del código, donde definimos las anotaciones que mencionamos al principio, es la siguiente:</p>
<div class="highlight"><pre><span></span><code><span class="mi">34</span>
<span class="mi">35</span>  <span class="c1">#Definir los parámetros x e y de modo que esta anotación apunte al valor máximo de la línea</span>
<span class="mi">36</span>  <span class="n">fig</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="c1">#Completar6,</span>
<span class="mi">37</span>                    <span class="n">y</span><span class="o">=</span><span class="c1">#Completar7,</span>
<span class="mi">38</span>                    <span class="n">text</span><span class="o">=</span><span class="s2">&quot;En x = </span><span class="si">{:.2f}</span><span class="s2"> alcanzó su valor máximo de </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="c1">#Completar6, Completar7),</span>
<span class="mi">39</span>                    <span class="n">showarrow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="mi">40</span>                    <span class="n">arrowhead</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="mi">41</span>
<span class="mi">42</span>  <span class="n">fig</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span><span class="n">axref</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span>
<span class="mi">43</span>                    <span class="n">ayref</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
<span class="mi">44</span>                    <span class="n">x</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
<span class="mi">45</span>                    <span class="n">y</span><span class="o">=</span><span class="c1">#Completar8,</span>
<span class="mi">46</span>                    <span class="n">ax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="mi">47</span>                    <span class="n">ay</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span>
<span class="mi">48</span>                    <span class="n">text</span><span class="o">=</span><span class="s2">&quot;El promedio de los valores es </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="c1">#Completar8),</span>
<span class="mi">49</span>                    <span class="n">showarrow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="mi">50</span>                    <span class="n">arrowhead</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="mi">51</span>
<span class="mi">52</span>  <span class="n">pyo</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;line_chart.html&#39;</span><span class="p">)</span>
</code></pre></div>
<p>En la línea 36, mediante la función <code>fig.add_annotation()</code>, agregamos la primera anotación, que sirve para señalar al punto máximo de la gráfica de línea.</p>
<p>En las líneas 36 y 37, deberás definir de manera apropiada los parámetros x e y para que esta anotación apunte a dicho máximo.</p>
<p>Observa que los elementos <strong>#Completar6</strong> y <strong>#Completar7</strong> también se usan en la línea 38, donde se define el texto de la anotación.</p>
<p>En la línea 42, mediante la función <code>fig.add_annotation()</code>, agregamos la segunda anotación, que sirve para señalar a la línea horizontal punteada.</p>
<p>En la línea 45, deberás definir de manera apropiada el  parámetro y para que dicha anotación apunte al punto sobre dicha línea  horizontal punteada donde x=0.6.</p>
<p>Observa que el elemento <strong>#Completar8</strong> también se usa en la línea 48, donde se define el texto de la anotación.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Pie">
      
        
        <a href="../js/" class="md-footer__link md-footer__link--prev" aria-label="Anterior: Js" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Anterior
              </span>
              Js
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      © 2021 PRG
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky"], "translations": {"clipboard.copy": "Copiar al portapapeles", "clipboard.copied": "Copiado al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}, "search": "../../assets/javascripts/workers/search.bd0b6b67.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.467223ff.min.js"></script>
      
        <script src="../../javascripts/config.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>